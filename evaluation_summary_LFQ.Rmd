---
output:
  html_document:
    df_print: paged
    fig.align: center
    self_contained: yes
    fig.height: 4
    fig.width: 8
    theme: united
    toc: yes
    toc_depth: 4
    toc_float: yes
    number_sections: yes
    code_folding: hide
title: "Auswertung TC Daten"
author: "David Lilek"
date: "`r format(Sys.time(), '%d %B %Y, %X')`"
---

# B - B20-B30-B40 - AF - TF


## Plots

```{r}
# load libraries
library(tidyverse)
library(dplyr)
library(UpSetR)
library(pheatmap)
library(ggvenn)

############## B
data <- readRDS(file = "results_v002/results_run1_mqpar_extracts_2gether_E4_D1_B_LFQ_combined_txt_proteinGroups.txt_LFQ.RDS")
data <- data[[1]]
data[] <- data > 0
data[is.na(data)]<- FALSE  
data_sub <- dplyr::select(data, contains("Pool_G"))
#get rid of FALSE values
B <- data_sub*1
B[B==0] <- NA
ind <- apply(B, 1, function(x) all(is.na(x)))
# B total proteins
nrow(B[!ind,])

# Comparison B20 (20220630) and B (20220609)
B20_0609 <- dplyr::select(data, contains("Pool_G"))
B20_0609 <- apply(B20_0609, 1, any)
B20_0630 <- dplyr::select(data, contains("20"))
B20_0630 <- apply(B20_0630, 1, any)
B20_comp <- as.data.frame(cbind(B20_0609,B20_0630))
B20_comp <- B20_comp*1
B20_comp[B20_comp==0] <- NA
# boxplot
boxplot(sum(B20_comp$B20_0609,na.rm = TRUE),
        sum(B20_comp$B20_0630,na.rm = TRUE),
        names = c("B20_0609","B20_0630"))
### analysis B
proteins <- as.data.frame(which(!is.na(B20_comp), arr.ind=TRUE))

B20_0609 <- proteins %>% dplyr::filter(col == 1)
B20_0630 <- proteins %>% dplyr::filter(col == 2)

# combine to list
lst <- list(B20_0609 = as.double(B20_0609[,1]),
            B20_0630 = as.double(B20_0630[,1]))

upset(fromList(lst), 
      order.by = "freq",
      nsets = 9,
      nintersects = 15,
      sets = c("B20_0609","B20_0630"),
      keep.order = TRUE,
      mainbar.y.label = "Number of shared proteins",
      sets.x.label = "Number of proteins per fraction",
      set_size.show = TRUE,
      set_size.angles = 0,
      set_size.scale_max = 1500
)


############AF
data <- readRDS(file = "results_v002/results_run1_mqpar_extracts_2gether_E4_D1_AF_TF_LFQ_combined_txt_proteinGroups.txt_LFQ.RDS")
data <- data[[1]]
data[] <- data > 0
data[is.na(data)]<- FALSE  
data_sub <- dplyr::select(data, contains("Pool_AF"))
#get rid of FALSE values
AF <- data_sub*1
AF[AF==0] <- NA
ind <- apply(AF, 1, function(x) all(is.na(x)))
# B total proteins
nrow(AF[!ind,])


############TF
data <- readRDS(file = "results_v002/results_run1_mqpar_extracts_2gether_E4_D1_AF_TF_LFQ_combined_txt_proteinGroups.txt_LFQ.RDS")
data <- data[[1]]
data[] <- data > 0
data[is.na(data)]<- FALSE  
data_sub <- dplyr::select(data, contains("Pool_TF"))
#get rid of FALSE values
TF <- data_sub*1
TF[TF==0] <- NA
ind <- apply(TF, 1, function(x) all(is.na(x)))
# B total proteins
nrow(TF[!ind,])







#################### MBR
data <- readRDS(file = "results_v002/results_run1_mqpar_extracts_2gether_E4_D1_B_MBR_LFQ_combined_txt_proteinGroups.txt_LFQ.RDS")
data <- data[[1]]
data[] <- data > 0
data[is.na(data)]<- FALSE  
data_sub <- dplyr::select(data, contains("Pool_G"))
#get rid of FALSE values
B <- data_sub*1
B[B==0] <- NA
ind <- apply(B, 1, function(x) all(is.na(x)))
# B total proteins
nrow(B[!ind,])

############AF
data <- readRDS(file = "results_v002/results_run1_mqpar_extracts_2gether_E4_D1_AF_TF_MBR_LFQ_combined_txt_proteinGroups.txt_LFQ.RDS")
data <- data[[1]]
data[] <- data > 0
data[is.na(data)]<- FALSE  
data_sub <- dplyr::select(data, contains("Pool_AF"))
#get rid of FALSE values
AF <- data_sub*1
AF[AF==0] <- NA
ind <- apply(AF, 1, function(x) all(is.na(x)))
# B total proteins
nrow(AF[!ind,])


############TF
data <- readRDS(file = "results_v002/results_run1_mqpar_extracts_2gether_E4_D1_AF_TF_MBR_LFQ_combined_txt_proteinGroups.txt_LFQ.RDS")
data <- data[[1]]
data[] <- data > 0
data[is.na(data)]<- FALSE  
data_sub <- dplyr::select(data, contains("Pool_TF"))
#get rid of FALSE values
TF <- data_sub*1
TF[TF==0] <- NA
ind <- apply(TF, 1, function(x) all(is.na(x)))
# B total proteins
nrow(TF[!ind,])



############## B 20-30-40
############## B
data <- readRDS(file = "results_v002/results_run1_mqpar_extracts_2gether_E4_D1_B_MBR_LFQ_combined_txt_proteinGroups.txt_LFQ.RDS")
data <- data[[1]]
data[] <- data > 0
data[is.na(data)]<- FALSE  
B <- dplyr::select(data, contains("Pool_20"))
B20 <- B
#get rid of FALSE values
B <- data_sub*1
B[B==0] <- NA
ind <- apply(B, 1, function(x) all(is.na(x)))
# B total proteins
nrow(B[!ind,])
B <- dplyr::select(data, contains("Pool_30"))
B30 <- B
#get rid of FALSE values
B <- data_sub*1
B[B==0] <- NA
ind <- apply(B, 1, function(x) all(is.na(x)))
# B total proteins
nrow(B[!ind,])
B40 <- dplyr::select(data, contains("Pool_40"))
#get rid of FALSE values
B <- data_sub*1
B[B==0] <- NA
ind <- apply(B, 1, function(x) all(is.na(x)))
# B total proteins
nrow(B[!ind,])

B20 <- apply(B20, 1, any)
B30 <- apply(B30, 1, any)
B40 <- apply(B40, 1, any)

B <- cbind(B20,B30,B40)
B <- as.data.frame(B)
B <- dplyr::select(B, contains("B"))
B <- B*1
B[B==0] <- NA

### analysis B
proteins <- as.data.frame(which(!is.na(B), arr.ind=TRUE))

B20 <- proteins %>% dplyr::filter(col == 1)
B30 <- proteins %>% dplyr::filter(col == 2)
B40 <- proteins %>% dplyr::filter(col == 3)

# combine to list
lst <- list(B20 = as.double(B20[,1]),
            B30 = as.double(B30[,1]),
            B40 = as.double(B40[,1]))

upset(fromList(lst), 
      order.by = "freq",
      nsets = 9,
      nintersects = 15,
      sets = c("B20","B30","B40"),
      keep.order = TRUE,
      mainbar.y.label = "Number of shared proteins",
      sets.x.label = "Number of proteins per fraction",
      set_size.show = TRUE,
      set_size.angles = 0,
      set_size.scale_max = 1500
)



## compare AF TF B poster
AF_TF_raw <- readRDS(file = "results_v002/results_run1_mqpar_extracts_2gether_E4_D1_AF_TF_LFQ_combined_txt_proteinGroups.txt_LFQ.RDS")
AF_TF_raw <- AF_TF_raw[[1]]
FASTA <- AF_TF_raw$FASTA
AF_TF_raw[] <- AF_TF_raw > 0
AF_TF_raw[is.na(AF_TF_raw)]<- FALSE  
AF <- dplyr::select(AF_TF_raw, contains("AF"))
AF <- apply(AF, 1, any)
AF <- as.data.frame(cbind(AF, FASTA))
TF <- dplyr::select(AF_TF_raw, contains("TF"))
TF <- apply(TF, 1, any)
TF <- as.data.frame(cbind(TF, FASTA))
B_raw <- readRDS(file = "results_v002/results_run1_mqpar_extracts_2gether_E4_D1_B_LFQ_combined_txt_proteinGroups.txt_LFQ.RDS")
B_raw <- B_raw[[1]]
FASTA <- B_raw$FASTA
B_raw[] <- B_raw > 0
B_raw[is.na(B_raw)]<- FALSE 
B <- dplyr::select(B_raw, contains("Pool_G"))
B <- apply(B, 1, any)
B <- as.data.frame(cbind(B, FASTA))

AF_TF_B_comparison  <- merge(B, AF,
                           all = TRUE,
                           by = "FASTA")
AF_TF_B_comparison <- merge(AF_TF_B_comparison, TF,
                            all = TRUE,
                            by = "FASTA")

AF_TF_B_comparison$B <- as.logical(AF_TF_B_comparison$B)
AF_TF_B_comparison$AF <- as.logical(AF_TF_B_comparison$AF)
AF_TF_B_comparison$TF <- as.logical(AF_TF_B_comparison$TF)
AF_TF_B_comparison <- AF_TF_B_comparison[,-1]*1
AF_TF_B_comparison[AF_TF_B_comparison==0] <- NA

# boxplot
boxplot(sum(AF_TF_B_comparison$B,na.rm = TRUE),
        sum(AF_TF_B_comparison$AF,na.rm = TRUE),
        sum(AF_TF_B_comparison$TF,na.rm = TRUE),
        names = c("B","AF","TF"))

proteins <- as.data.frame(which(!is.na(AF_TF_B_comparison), arr.ind=TRUE))

B <- proteins %>% dplyr::filter(col == 1)
AF <- proteins %>% dplyr::filter(col == 2)
TF <- proteins %>% dplyr::filter(col == 3)


# combine to list
lst <- list("B"=as.double(B[,1]),
            "AF"=as.double(AF[,1]),
            "TF"=as.double(TF[,1]))

upset(fromList(lst), 
      order.by = "freq",
      nsets = 10,
      nintersects = 15,
      keep.order = TRUE,
      sets=c("B", "AF", "TF"),
      mainbar.y.label = "Number of shared proteins",
      sets.x.label = "Number of proteins per fraction",
      set_size.show = TRUE,
      set_size.angles = 0,
      set_size.scale_max = 1000
)


#get colors
#total protein extract
total <- rgb(255,93,93, maxColorValue = 255)
#fractions high MW SEC
highMW <- rgb(169,208,142,maxColorValue = 255)
#fractions low MW SEC
lowMW <- rgb(255,217,102, maxColorValue = 255)
#in-gel digest
IG <- rgb(180,198,231,maxColorValue = 255)

ggvenn(lst,
       fill_color = c(IG,lowMW,highMW),
       stroke_size = 0.5, set_name_size = 5, text_size = 4.25, digits = 0, fill_alpha = 0.9, label_sep = )
ggsave("./pics/LFQ_AF_TF_B.png")
#compare B to pool from 0609 
B_raw <- readRDS(file = "results_v002/results_run1_mqpar_extracts_2gether_E4_D1_B_LFQ_combined_txt_proteinGroups.txt_LFQ.RDS")
B_raw <- B_raw[[1]]
FASTA <- B_raw$FASTA
B_raw[] <- B_raw > 0
B_raw[is.na(B_raw)]<- FALSE 
B <- dplyr::select(B_raw, contains("Pool_G"))
B <- apply(B, 1, any)
B <- as.data.frame(cbind(B, FASTA))
aj_raw <- readRDS(file = "results_v002/results_run1_mqpar_extracts_2gether_E4_D1_a-j_LFQ_combined_txt_proteinGroups.txt_LFQ.RDS")
aj_raw <- aj_raw[[1]]
FASTA <- aj_raw$FASTA
aj_raw[] <- aj_raw > 0
aj_raw[is.na(aj_raw)]<- FALSE 
aj <- dplyr::select(aj_raw, contains("Pool"))
aj <- apply(aj, 1, any)
aj <- as.data.frame(cbind(aj, FASTA))
B_aj_comparison  <- merge(B, aj,
                             all = TRUE,
                             by = "FASTA")

B_aj_comparison$B <- as.logical(B_aj_comparison$B)
B_aj_comparison$aj <- as.logical(B_aj_comparison$aj)
B_aj_comparison <- B_aj_comparison[,-1]*1
B_aj_comparison[B_aj_comparison==0] <- NA
boxplot(sum(B_aj_comparison$B,na.rm = TRUE),
        sum(B_aj_comparison$aj,na.rm = TRUE),
        names = c("B","E4_D1_pool"))

proteins <- as.data.frame(which(!is.na(B_aj_comparison), arr.ind=TRUE))

B_inter <- proteins %>% dplyr::filter(col == 1)
aj_inter <- proteins %>% dplyr::filter(col == 2)

# combine to list
lst <- list("B"=as.double(B_inter[,1]),
            "E4_D1_pool"=as.double(aj_inter[,1]))

upset(fromList(lst), 
      order.by = "freq",
      nsets = 10,
      nintersects = 15,
      keep.order = TRUE,
      sets=c("B", "E4_D1_pool"),
      mainbar.y.label = "Number of shared proteins",
      sets.x.label = "Number of proteins per fraction",
      set_size.show = TRUE,
      set_size.angles = 0,
      set_size.scale_max = 1000
)

ggvenn(lst,
       stroke_size = 0.5, set_name_size = 5, text_size = 4, digits = 0, fill_alpha = 0.9)
ggsave("./pics/LFQ_B_D1pool.png")




```

# extract a-j with pool (0609)

## compare a-j

```{r}
## compare A-J with pool
aj_raw <- readRDS(file = "results_v002/results_run1_mqpar_extracts_2gether_E4_D1_a-j_LFQ_combined_txt_proteinGroups.txt_LFQ.RDS")
aj_raw <- aj_raw[[1]]
aj_raw[] <- aj_raw > 0
aj_raw[is.na(aj_raw)]<- FALSE 
aj <- dplyr::select(aj_raw, -contains(c("Pool","FASTA")))
aj_pool <- dplyr::select(aj_raw, contains("Pool"))

ltters <- paste("_", letters[1:10],"_", sep = "")
for (i in seq(1:10)){
  tmp <- dplyr::select(aj, contains(ltters[i]))
  #use M as selector 
  aj[,paste(ltters[i],"M",sep="")] <- apply(tmp, 1, any)

}
aj <- dplyr::select(aj, contains(paste(ltters,"M",sep="")))
aj <- aj*1
aj[aj==0]<- NA

colnames(aj) <- letters[1:10]
sum <- as.data.frame(t(colSums(aj,na.rm = TRUE)))
boxplot(sum)

#prepare data 
proteins <- as.data.frame(which(!is.na(aj), arr.ind=TRUE))
a <- proteins %>% dplyr::filter(col == 1)
b <- proteins %>% dplyr::filter(col == 2)
c <- proteins %>% dplyr::filter(col == 3)
d <- proteins %>% dplyr::filter(col == 4)
e <- proteins %>% dplyr::filter(col == 5)
f <- proteins %>% dplyr::filter(col == 6)
g <- proteins %>% dplyr::filter(col == 7)
h <- proteins %>% dplyr::filter(col == 8)
i <- proteins %>% dplyr::filter(col == 9)
j <- proteins %>% dplyr::filter(col == 10)

# combine to list
lst <- list(a=as.double(a[,1]),
            b=as.double(b[,1]),
            c=as.double(c[,1]),
            d=as.double(d[,1]),
            e=as.double(e[,1]),
            f=as.double(f[,1]),
            g=as.double(g[,1]),
            h=as.double(h[,1]),
            i=as.double(i[,1]),
            j=as.double(j[,1]))        
upset(fromList(lst), 
      order.by = "freq",
      nsets = 10,
      nintersects = 15,
      keep.order = TRUE,
      sets=letters[1:10],
      mainbar.y.label = "Number of shared proteins",
      sets.x.label = "Number of proteins per fraction",
      set_size.show = TRUE,
      set_size.angles = 0,
      set_size.scale_max = 1000
)



```

## Compare a-j with pool

```{r}
# compare with pool
aj_pool <- apply(aj_pool, 1, any)
aj_pool <- aj_pool*1
aj_pool[aj_pool==0]<- NA

aj_pool_comp <- aj
aj_pool_comp$pool <- aj_pool

sum <- as.data.frame(t(colSums(aj_pool_comp,na.rm = TRUE)))
boxplot(sum)

#prepare data 
proteins <- as.data.frame(which(!is.na(aj_pool_comp), arr.ind=TRUE))
a <- proteins %>% dplyr::filter(col == 1)
b <- proteins %>% dplyr::filter(col == 2)
c <- proteins %>% dplyr::filter(col == 3)
d <- proteins %>% dplyr::filter(col == 4)
e <- proteins %>% dplyr::filter(col == 5)
f <- proteins %>% dplyr::filter(col == 6)
g <- proteins %>% dplyr::filter(col == 7)
h <- proteins %>% dplyr::filter(col == 8)
i <- proteins %>% dplyr::filter(col == 9)
j <- proteins %>% dplyr::filter(col == 10)
pool <- proteins %>% dplyr::filter(col == 11)

# combine to list
lst <- list(a=as.double(a[,1]),
            b=as.double(b[,1]),
            c=as.double(c[,1]),
            d=as.double(d[,1]),
            e=as.double(e[,1]),
            f=as.double(f[,1]),
            g=as.double(g[,1]),
            h=as.double(h[,1]),
            i=as.double(i[,1]),
            j=as.double(j[,1]),
            pool=as.double(pool[,1]))        
upset(fromList(lst), 
      order.by = "freq",
      nsets = 10,
      nintersects = 15,
      keep.order = TRUE,
      sets=c(letters[1:10],"pool"),
      mainbar.y.label = "Number of shared proteins",
      sets.x.label = "Number of proteins per fraction",
      set_size.show = TRUE,
      set_size.angles = 0,
      set_size.scale_max = 1000
)
```


# D2

```{r}
#############################
# D2
###############################
data <- readRDS(file = "results_v002/results_run1_mqpar_extracts_2gether_D2_LFQ_combined_txt_proteinGroups.txt_LFQ.RDS")
data <- data[[1]]
data[] <- data > 0
data[is.na(data)]<- FALSE  
data_sub <- dplyr::select(data, contains("Pool_20"))
B_D2 <- data_sub*1
B_D2[B_D2==0] <- NA


### analysis B
proteins <- as.data.frame(which(!is.na(B_D2), arr.ind=TRUE))

B1 <- proteins %>% dplyr::filter(col == 1)
B10 <- proteins %>% dplyr::filter(col == 2)
B2 <- proteins %>% dplyr::filter(col == 3)
B3 <- proteins %>% dplyr::filter(col == 4)
B4 <- proteins %>% dplyr::filter(col == 5)
B5 <- proteins %>% dplyr::filter(col == 6)
B6 <- proteins %>% dplyr::filter(col == 7)
B7 <- proteins %>% dplyr::filter(col == 8)
B8 <- proteins %>% dplyr::filter(col == 9)
B9 <- proteins %>% dplyr::filter(col == 10)
# combine to list
lst <- list(B1 = as.double(B1[,1]),
            B2 = as.double(B2[,1]),
            B3 = as.double(B3[,1]),
            B4 = as.double(B4[,1]),
            B5 = as.double(B5[,1]),
            B6 = as.double(B6[,1]),
            B7 = as.double(B7[,1]),
            B8 = as.double(B8[,1]),
            B9 = as.double(B9[,1]),
            B10 = as.double(B10[,1]))            

upset(fromList(lst), 
      order.by = "freq",
      nsets = 9,
      nintersects = 15,
      sets = c("B1","B2","B3","B4","B5","B6","B7","B8","B9","B10"),
      keep.order = TRUE,
      mainbar.y.label = "Number of shared proteins",
      sets.x.label = "Number of proteins per fraction",
      set_size.show = TRUE,
      set_size.angles = 0,
      set_size.scale_max = 1000
)


data_D2_pool <- dplyr::select(data, contains("Gesamt"))
data_D2_pool <- apply(data_D2_pool, 1, any)
data_D2_fractions <- dplyr::select(data, contains("20"))
data_D2_fractions <- apply(data_D2_fractions, 1, any)
data_D2 <- as.data.frame(cbind(data_D2_pool,data_D2_fractions))
data_D2 <- data_D2*1
data_D2[data_D2==0] <- NA
# boxplot
boxplot(sum(data_D2$data_D2_pool,na.rm = TRUE),
        sum(data_D2$data_D2_fractions,na.rm = TRUE),
        names = c("D2 pool","D2 fractions"))


proteins <- as.data.frame(which(!is.na(data_D2), arr.ind=TRUE))

D2_pool_inter <- proteins %>% dplyr::filter(col == 1)
D2_fractions_inter <- proteins %>% dplyr::filter(col == 2)

# combine to list
lst <- list(D2_pool=as.double(D2_pool_inter[,1]),
            D2_fractions=as.double(D2_fractions_inter[,1]))

upset(fromList(lst), 
      order.by = "freq",
      nsets = 10,
      nintersects = 15,
      keep.order = TRUE,
      sets=c("D2_pool", "D2_fractions"),
      mainbar.y.label = "Number of shared proteins",
      sets.x.label = "Number of proteins per fraction",
      set_size.show = TRUE,
      set_size.angles = 0,
      set_size.scale_max = 1000
)

#venn digarams
#get colors
D2_pool_col <- rgb(255,93,93, maxColorValue = 255)
D2_ingel_col <- rgb(169,208,142,maxColorValue = 255)
#E4_D1_pool_col <- rgb(255,217,102, maxColorValue = 255)

ggvenn(lst,
       fill_color = c(D2_pool_col,D2_ingel_col),
       stroke_size = 0.5, set_name_size = 5, text_size = 4, digits = 0, fill_alpha = 0.9)
ggsave("./pics/LFQ_D2_.png")

```


# Compare D1-D2

```{r}
# D1-D2 comparison

D1_raw <- readRDS(file = "results_v002/results_run1_mqpar_extracts_2gether_E4_D1_B_LFQ_combined_txt_proteinGroups.txt_LFQ.RDS")
D1_raw <- D1_raw[[1]]
FASTA <- D1_raw$FASTA
D1_raw[] <- D1_raw > 0
D1_raw[is.na(D1_raw)]<- FALSE 
D1 <- dplyr::select(D1_raw, contains("20"))
D1 <- apply(D1, 1, any)
D1 <- as.data.frame(cbind(D1, FASTA))
D2_raw <- readRDS(file = "results_v002/results_run1_mqpar_extracts_2gether_D2_LFQ_combined_txt_proteinGroups.txt_LFQ.RDS")
D2_raw <- D2_raw[[1]]
FASTA <- D2_raw$FASTA
D2_raw[] <- D2_raw > 0
D2_raw[is.na(D2_raw)]<- FALSE 
D2 <- dplyr::select(data, contains("Pool_20"))
D2 <- apply(D2, 1, any)
D2 <- as.data.frame(cbind(D2, FASTA))
D1_D2_comparison  <- merge(D1, D2,
                           all = TRUE,
                           by = "FASTA")

D1_D2_comparison$D1 <- as.logical(D1_D2_comparison$D1)
D1_D2_comparison$D2 <- as.logical(D1_D2_comparison$D2)
D1_D2_comparison <- D1_D2_comparison[,-1]*1
D1_D2_comparison[D1_D2_comparison==0] <- NA

# boxplot
boxplot(sum(D1_D2_comparison$D1,na.rm = TRUE),
        sum(D1_D2_comparison$D2,na.rm = TRUE),
        names = c("D1","D2"))

proteins <- as.data.frame(which(!is.na(D1_D2_comparison), arr.ind=TRUE))

D1_inter <- proteins %>% dplyr::filter(col == 1)
D2_inter <- proteins %>% dplyr::filter(col == 2)

# combine to list
lst <- list("D1\ningeldigest_pool"=as.double(D1_inter[,1]),
            "D2\ningeldigest_pool"=as.double(D2_inter[,1]))

upset(fromList(lst), 
      order.by = "freq",
      nsets = 10,
      nintersects = 15,
      keep.order = TRUE,
      sets=c("D1\ningeldigest_pool", "D2\ningeldigest_pool"),
      mainbar.y.label = "Number of shared proteins",
      sets.x.label = "Number of proteins per fraction",
      set_size.show = TRUE,
      set_size.angles = 0,
      set_size.scale_max = 1000
)

#venn digarams
#get colors
D1_col <- rgb(255,93,93, maxColorValue = 255)
D2_col <- rgb(169,208,142,maxColorValue = 255)
#E4_D1_pool_col <- rgb(255,217,102, maxColorValue = 255)

ggvenn(lst,
       fill_color = c(D1_col,D2_col),
       stroke_size = 0.5, set_name_size = 4, text_size = 4, digits = 0, fill_alpha = 0.9)
ggsave("./pics/LFQ_D1_D2.png")
```


# Besprechen/todo

* nehmen wir LFQ oder die identifizierten Proteine?
* nehmen wir razor oder unique? ich würde fast razor nehmen, weil ja ohnehin zu der proteingruppe zugeordnet wird die am wahrscheinlichsten ist
* wie poolen wir? zB B1_1, B1_2, B2_1, B2_2...
  + wenn ich dort alle Proteine zähle führt es ev. zu einem Überbefund?
  + wäre es nicht besser B1_1 und B1_2 -> nur wenn Protein in beiden vorkommt ist es auch da? weil ja technische replikate also 2x gemessen oder?
  + wenn 2 biologische replikate; also 2x extrahiert würde ich es so machen, dass ich auch sagen es ist da wenn es nur in einem Extrakt vorkommt | also zB B1_1 TRUE - B1_2 FALSE
* was gehört überhaupt gepooled und verglichen? können wir uns das bitte noch anschauen?
* was gehört bei D2 gepooled und verglichen?


* man könnte ja Razor nehmen und im paper bezug nehmen, dass ergebnisse ähnlich wie unique
* zusätzlich noch anschauen mit LFQ? wieviele proteine von den identifzierten sind überhaupt quantifizierbar? das könnte man auch ins paper geben, dass wenn man lfq nimmt man mit ca. 20-25%(also je nachdem was dann rauskommt) rechnen muss? weil ja später dann bei differential expression analysis ja auch quantifizierte proteine verwendet werden; also meistens halt

