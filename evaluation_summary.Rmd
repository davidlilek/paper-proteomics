---
output:
  html_document:
    df_print: paged
    fig.align: center
    self_contained: yes
    fig.height: 4
    fig.width: 8
    theme: united
    toc: yes
    toc_depth: 4
    toc_float: yes
    number_sections: yes
    code_folding: hide
title: "Auswertung TC Daten"
author: "David Lilek"
date: "`r format(Sys.time(), '%d %B %Y, %X')`"
---

# Vergleich Unique-Razor | noMBR-MBR | Razor-LFQ

## Unique-Razor

* Boxplot
  + generell werden mit Razor etwas mehr Proteine gefunden egal ob MBR oder noMBR verwendet wird - das ist auch statistisch signifikant (paired t-Test)
  + bei MBR werden ca. 10 Proteine mehr gefunden wenn Razor verwendet wird
  + bei noMBR ca. 7.41
  + bei noMBR gibt es manche Proben die etwas mehr Proteine mit Razor zeigen als Unique
* es zeigt sich, dass der Unterschied Razor/Unique von der Anzahl der gefundenden Proteine anbhängt


```{r}
data <- read.csv("Extraktionen_gesamt_V2_DL.csv", sep=";")
# unique vs razor
MBR <- (data$Razor.MBR.2.peptides/data$Unique.MBR.2.peptides)*100
noMBR <- (data$Razor.noMBR.2.peptides/data$Unique.no.MBR.2.peptides)*100

boxplot(MBR, noMBR, main = "Abweichung Razor vs Unique [%]", names = c("MBR", "noMBR"))

mean_MBR <- (data$Razor.MBR.2.peptides+data$Unique.MBR.2.peptide)/2
mean_noMBR <- (data$Razor.noMBR.2.peptides+data$Unique.no.MBR.2.peptides)/2

plot(mean_MBR,MBR, xlab= "Number proteins", ylab="Abweichung Razor vs. Unique", main = "MBR")
plot(mean_noMBR,noMBR, xlab= "Number proteins", ylab="Abweichung Razor vs. Unique", main = "noMBR")

#t.test(data$Razor.noMBR.2.peptides,data$Unique.no.MBR.2.peptides,paired = TRUE)
#t.test(data$Razor.MBR.2.peptides,data$Unique.MBR.2.peptides,paired = TRUE)
```

## MBR vs. noMBR

* Boxplot: Mit MBR können teilweise bis zu 4x mehr Proteine gefunden werden als bei Nichtverwendung von MBR. Die Unterschiede zwischen Razor bzw. Unique sind gering.
* klar ist eine Abhänigkeit von der Gesamtanzahl an gefundenen Proteinen ersichtlich
* ab ca. 350 gefundenen Proteinen bleiben die mehr gefundenen Proteinen auf einem ähnlichen Level
* darunter steigt die Anzahl der gefundenen Proteine mit MBR dramatatisch an wenn sich die Gesamtanzahl an Proteinen reduziert
* dies ist unabhängig ob Razor oder Unique verwendet wird


```{r}
#MBR evaluation
unique <- (data$Unique.MBR.2.peptides/data$Unique.no.MBR.2.peptides)*100
razor <- (data$Razor.MBR.2.peptides/data$Razor.noMBR.2.peptides)*100

boxplot(unique,razor, main = "Abweichung MBR", names = c("Unique", "Razor"))

mean_unique <- (data$Unique.MBR.2.peptides+data$Unique.no.MBR.2.peptides)/2
mean_razor <- (data$Razor.noMBR.2.peptides+data$Razor.MBR.2.peptides)/2

plot(mean_razor,razor, xlab= "Number proteins", ylab="Abweichung MBR", main = "Razor")
plot(mean_unique,unique, xlab= "Number proteins", ylab="Abweichung MBR", main="Unique")

```

## Razor-LFQ

* mit Razor werden im Median 6% mehr Proteine gefunden wenn MBR verwendet wird
* bei noMBR sind es 11%
* es zeigt sich, dass der Unterschied Razor/LFQ nicht von der Anzahl der gefundenen Proteine abhängt


```{r}
data <- read.csv("Extraktionen_gesamt_V2_DL.csv", sep=";")
# unique vs razor
MBR <- (data$Razor.MBR.2.peptides/data$LFQ.MBR)*100
noMBR <- (data$Razor.noMBR.2.peptides/data$LFQ.noMBR)*100

boxplot(MBR, noMBR, main = "Abweichung Razor vs LFQ [%]", names = c("MBR", "noMBR"))

mean_MBR <- (data$Razor.MBR.2.peptides+data$LFQ.MBR)/2
mean_noMBR <- (data$Razor.noMBR.2.peptides+data$LFQ.noMBR)/2

plot(mean_MBR,MBR, xlab= "Number proteins", ylab="Abweichung Razor vs. LFQ", main = "MBR")
plot(mean_noMBR,noMBR, xlab= "Number proteins", ylab="Abweichung Razor vs. LFQ", main = "noMBR")

#t.test(data$Razor.noMBR.2.peptides,data$Unique.no.MBR.2.peptides,paired = TRUE)
#t.test(data$Razor.MBR.2.peptides,data$Unique.MBR.2.peptides,paired = TRUE)
```

## Summary data analysis

* die unten folgenden Auswertungen wurden mit MBR und noMBR bzw Razor, Unique und LFQ durchgeführt
* es zeigt sich, dass unabhängig von MBR oder noMBR nur geringe Unterschiede zwischen Razor und Unique zu finden sind; die Aussage bleibt diesselbe
* vergleicht man MBR und noMBR so weißt MBR etwas höhere Identifikationsraten auf wie schon oben gezeigt
* in einem ersten Vergleich scheint es, dass es mehr gesharte Proteine zwischen den einzelnen Treatments gibt
  + zB B-AF-TF noMBR 30% gemeinsam; MBR 35% gemeinsam
  + zB B-TF noMBR 4%; MBR 7%
  + gerade bei gemeinsam prozessierten Extrakten steigert es sich noch etwas extremer
  + D2_pool mit D2_pool_fractions: noMBR 53% gemeinsam; MBR 69% gemeinsam
* LFQ
  + mit MBR mehr gemeinsam gerade wenn gemeinsam ausgewertet
  + sonst halt mit LFQ tendentiell weniger aber trotzdem ähnliche Verhältnisse wie bei Razor bzw Unique

## Venn diagrams

```{r results='asis'}
pth <- "X:/wissenschaftliche Veröffentlichungen/Publikationen/2022/Proteomics_JRS_DL/data/pics/"
filelist = list.files(path = pth, pattern = ".*.png")
filelist <- as.list(filelist)
for (file in filelist){
  filename <- paste(pth,file,sep="")
  #print(filename)
  cat("\n")
  cat("###",file,"\n")
  cat("\n")
  cat("![](",filename,")")
  cat("\n")
}

```



# Besprechen/todo

* nehmen wir LFQ oder die identifizierten Proteine?
* nehmen wir razor oder unique? ich würde fast razor nehmen, weil ja ohnehin zu der proteingruppe zugeordnet wird die am wahrscheinlichsten ist
* wie poolen wir? zB B1_1, B1_2, B2_1, B2_2...
  + wenn ich dort alle Proteine zähle führt es ev. zu einem Überbefund?
  + wäre es nicht besser B1_1 und B1_2 -> nur wenn Protein in beiden vorkommt ist es auch da? weil ja technische replikate also 2x gemessen oder?
  + wenn 2 biologische replikate; also 2x extrahiert würde ich es so machen, dass ich auch sagen es ist da wenn es nur in einem Extrakt vorkommt | also zB B1_1 TRUE - B1_2 FALSE
* was gehört überhaupt gepooled und verglichen? können wir uns das bitte noch anschauen?
* was gehört bei D2 gepooled und verglichen?


* man könnte ja Razor nehmen und im paper bezug nehmen, dass ergebnisse ähnlich wie unique
* zusätzlich noch anschauen mit LFQ? wieviele proteine von den identifzierten sind überhaupt quantifizierbar? das könnte man auch ins paper geben, dass wenn man lfq nimmt man mit ca. 20-25%(also je nachdem was dann rauskommt) rechnen muss? weil ja später dann bei differential expression analysis ja auch quantifizierte proteine verwendet werden; also meistens halt

